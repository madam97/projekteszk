<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Projekt Eszközök beadandó: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Projekt Eszközök beadandó
   </div>
   <div id="projectbrief">Az ELTE Projekt Eszközök nevű tárgyra készített beadandó</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Projekt Eszközök beadandó Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.org/madam97/projekteszk">![Build Status](https://travis-ci.com/madam97/projekteszk.svg?branch=master)</a> <a href="https://snyk.io/test/github/madam97/projekteszk">![Known Vulnerabilities](https://snyk.io/test/github/madam97/projekteszk/badge.svg)</a></p>
<p><a href="https://madam97.github.io/projekteszk/">Doxygen dokumentáció</a></p>
<h2>Mappa tartalma</h2>
<ul>
<li>docs: ebben a mappában vannak az oldalhoz szükséges dokumentumok</li>
<li>images: képek, melyek megjelennek az oldalon</li>
<li>src/backend: backend működéséhez szükséges fájlok (Java, SQL)</li>
<li>src/frontend: frontend működéséhez szükséges fájlok (HTML, CSS, TypeScript)</li>
<li>src/test: teszt fájlok</li>
</ul>
<h2>Rövid leírás</h2>
<p>Az API egy horgász webshophoz tartozó termékek adatait fogja kezelni. Ezen felül pedig lehetőség lesz területi jegy váltására is, így a horgászcikkek mellett a jegyvásárláshoz szükséges adatokat is kezelni fogjuk. Ezek a horgászvízek és a horgászegyesületek adatai. Az API mindezeken túl "hozzáfér" a MOHOSZ adatbázisához, ahol a horgászok adatait tudja majd lekérni, bizonyos ellenőrzések céljából. A termékeket lehet belépés nélkül is böngészni, viszont a vásárláshoz regisztráció szükséges.</p>
<h2>Szerepkörök</h2>
<ul>
<li><em>regisztrálatlan felhasználó (ROLE_GUEST):</em> tud böngészni a termékek között, de a vásárláshoz regisztrálnie kell</li>
<li><em>regisztrált felhasználó (ROLE_USER):</em> tud termékeket vásárolni, illetve területi jegyet is, ha megadta a horgászkártyája számát és a rendszer ellenőrizte annak hitelességét a MOHOSZ adazbázisban; továbbá megtekintheti és törölheti a rendeléseit</li>
<li><em>admin felhasználó (ROLE_ADMIN):</em> olyan felhasználó, aki látja, módosíthatja és törölheti a termékeket, illetve azok adatait, továbbá felhasználót is törölhet</li>
</ul>
<h2>Funkcionális követelmények</h2>
<h3>Vásárlás / Horgászat menete</h3>
<p>Regisztráció után a felhasználónak lehetősége van horgászcikkek és területi jegyek vásárlására. Horgászcikk vásárlásakor kereshet terméknévre, illetve lehetősége van a termékek szűrésére típus, valamint gyártó szerint. Egy termék vásárlása ugyanúgy történik, mint egy átlagos webshopnál.</p>
<p>A területi jegy vásárlása már kicsit érdekesebb. Először is ahhoz, hogy egy ember horgászhasson, két dolgot tehet.</p>
<p>Az első, hogy leteszi a horgászvizsgát, ezek után pedig egy horgászegyesület tagjának kell lennie (akinek éves díjat fizet). Minden évben meg kell vennie az állami horgászjegyet, amihez kap egy fogási naplót is. Ezek után vehet területi jegyet az adott vízre és horgászhat. Ha kifogott egy halat és el is viszi azt, akkor azt be kell írnia a fogási naplóba. Minden év január végéig le kell adnia a legközelebbi horgászegyesületnél az előző évi fogási naplót, különben nem veheti meg a következő állami horgászjegyet.</p>
<p>A második, hogy egy internetes vizsga kitöltése után a személy jogosult ún. turista állami horgászjegy váltására. Ez a jegy a váltás időpontjától számítva 90 napig érvényes és a horgász emellé is kap egy fogási naplót, amit vezetnie kell és a turista állami horgászjegy lejártától számított 30 napon belül be kell küldenie a NÉBIH-nek.</p>
<p>Tehát területi jegy vásárlásakor a kártyaszám megadása után a rendszer a következőket ellenőrzi:</p>
<ul>
<li>a megadott kártyaszám megtalálható-e a MOHOSZ adatbázisában</li>
<li>ha igen, akkor a megadott kártya érvényes-e még</li>
<li>van-e a horgásznak érvényes állami horgászjegye (fishing_license_num not null)</li>
<li>van-e a horgásznak valami kihágása, ami miatt az adott évben nem horgászhat (is_disabled)</li>
</ul>
<p>Ha mindezeket rendben találta, akkor a felhasználó jogosult területi jegy vásárlására.</p>
<h3>SQL táblák</h3>
<div class="image">
<img src="https://github.com/madam97/projekteszk/blob/master/images/documentation/db.jpg"  alt="SQL Tables" title="SQL táblák"/>
</div>
<h4>Products</h4>
<p>Ebben a táblában tároljuk a horgász termékeket. Itt érdemes szót ejteni a a típusról, ami a következők lehetnek: bot, csali, horog, műcsali, orsó, zsinór, ruha, egyéb kiegészítő</p>
<table class="doxtable">
<tr>
<th>Oszlopnév </th><th align="center">Típus </th><th align="right">Leírás  </th></tr>
<tr>
<td>id </td><td align="center">int </td><td align="right">elsődleges kulcs </td></tr>
<tr>
<td>name </td><td align="center">varchar </td><td align="right">a termék neve </td></tr>
<tr>
<td>type </td><td align="center">varchar </td><td align="right">a termék típusa </td></tr>
<tr>
<td>manufacturer </td><td align="center">varchar </td><td align="right">a termék gyártója </td></tr>
<tr>
<td>price </td><td align="center">int </td><td align="right">a termék ára </td></tr>
<tr>
<td>desc </td><td align="center">varchar </td><td align="right">a termék leírása </td></tr>
</table>
<h4>Order</h4>
<p>Ebben a táblában tároljuk egy felhasználó rendeléseit. Külön van választva a horgászcikk vásárlás és a területi jegy vásárlás, mert a területi jegy vásárláshoz a regisztráció során megadott alapadatokon kívül meg kell adni a horgászkártya számát is. Ugyanis 2019-től a hagyományos papír alapú horgászihazolványt felváltotta a horgászkártya. A kártyaszám megadása után a rendszer leellenőrzi a MOHOSZ adatbázisában, (Mohosz tábla) hogy a megadott kártyaszám regisztrálva van-e a rendszerbe, illetve, hogy minden adott-e ahhoz, hogy a horgász felhasználó területi jegyet vehessen.</p>
<table class="doxtable">
<tr>
<th>Oszlopnév </th><th align="center">Típus </th><th align="right">Leírás  </th></tr>
<tr>
<td>id </td><td align="center">int </td><td align="right">elsődleges kulcs </td></tr>
<tr>
<td>user_id </td><td align="center">int </td><td align="right">a felhasználó ID-je </td></tr>
<tr>
<td>product_id </td><td align="center">int </td><td align="right">a megvásárolni kívánt termék ID-je </td></tr>
<tr>
<td>ticket_id </td><td align="center">int </td><td align="right">a megvásárolni kívánt területi jegy ID-je </td></tr>
<tr>
<td>start </td><td align="center">date </td><td align="right">területi jegy érvényességének kezdete </td></tr>
<tr>
<td>end </td><td align="center">date </td><td align="right">területi jegy érvényességének vége </td></tr>
</table>
<h4>Tickets</h4>
<p>Ebben a táblában tároljuk a területi jegyeket és azok adatait. Minden területi jegy egy adott vízterülethez tartozik és a típusa határozza meg az érvényességi idejét. Vannak napijegyek, hetijegyek, illetve éves jegyek. Mindezekből pedig van általános és turista. Vásárláskor a felhasználó megadhatja a kezdődátumot, hogy mikortól kezdődjön a jegy érvényessége.</p>
<table class="doxtable">
<tr>
<th>Oszlopnév </th><th align="center">Típus </th><th align="right">Leírás  </th></tr>
<tr>
<td>id </td><td align="center">int </td><td align="right">elsődleges kulcs </td></tr>
<tr>
<td>spot_id </td><td align="center">int </td><td align="right">a vízterület ID-je, ahova szól a jegy </td></tr>
<tr>
<td>type </td><td align="center">varchar </td><td align="right">a jegy típusa </td></tr>
<tr>
<td>price </td><td align="center">int </td><td align="right">a jegy ára </td></tr>
</table>
<h4>User</h4>
<p>Ebben a táblában tároljuk a felhasználó adatait. Regisztrációkor a felhasználónak kötelezően meg kell adnia a nevét, e-mail címét (ez lesz a felhasználóneve) és egy jelszót. Amikor terméket akar vásárolni, akkor szükséges lesz még megadnia a telefonszámát és a címét. Továbbá ha területi jegyet is szeretne vásárolni, akkor meg kell adnia a horgászkártyájának a számát is. Ezeket az adatokat nem kötelező a regisztrációkor megadni, de a vásárláshoz elengedhetetlenül szükségesek.</p>
<table class="doxtable">
<tr>
<th>Oszlopnév </th><th align="center">Típus </th><th align="right">Leírás  </th></tr>
<tr>
<td>id </td><td align="center">int </td><td align="right">elsődleges kulcs </td></tr>
<tr>
<td>card_id </td><td align="center">int </td><td align="right">horgászkáryta ID-je (száma) </td></tr>
<tr>
<td>name </td><td align="center">varchar </td><td align="right">a felhasználó születési neve </td></tr>
<tr>
<td>email </td><td align="center">varchar </td><td align="right">a felhasználó e-mail címe (felhasználóneve) </td></tr>
<tr>
<td>pass </td><td align="center">varchar </td><td align="right">a belépéshez szükséges jelszó </td></tr>
<tr>
<td>role </td><td align="center">enum </td><td align="right">regisztrálatlan felhasználó (ROLE_GUEST), regisztrált felhasználó (ROLE_USER), vagy admin felhasználó (ROLE_ADMIN) </td></tr>
<tr>
<td>phone </td><td align="center">varchar </td><td align="right">a felhasználó telefonszáma </td></tr>
<tr>
<td>address </td><td align="center">varchar </td><td align="right">a felhasználó lakcíme </td></tr>
</table>
<h4>Spots</h4>
<p>Ebben a táblában tároljuk a vízterületeket és azok adatait. Területi jegy vásárlásakor a felhasználó engedélyt kap az adott vízterületen történő horgászatra meghatározott időre. Minden egyes vízterület egy horgászegyesület birtokában van, ők tartjűk fenn azt (terület gondozása, halak betelepítése, stb.).</p>
<table class="doxtable">
<tr>
<th>Oszlopnév </th><th align="center">Típus </th><th align="right">Leírás  </th></tr>
<tr>
<td>id </td><td align="center">int </td><td align="right">elsődleges kulcs (víztérkód) </td></tr>
<tr>
<td>club_id </td><td align="center">int </td><td align="right">a horgászegyesület ID-je (tulajdonos) </td></tr>
<tr>
<td>name </td><td align="center">varchar </td><td align="right">a vízterület neve </td></tr>
<tr>
<td>desc </td><td align="center">varchar </td><td align="right">a vízterület leírása </td></tr>
</table>
<h4>Clubs</h4>
<p>Ebben a táblában tároljuk a horgászegyesületeket és azok adatait. Minden horgászegyesületnek van egy neve és egy megye, ahol az egyesület megtalálható. A horgászvízekhez nem rendeltünk külön megye adattagot, mert a szimuláció során azt feltételezzük, hogy a horgászegyesület a saját megyéjén belül birtokol csak horgászvízeket.</p>
<table class="doxtable">
<tr>
<th>Oszlopnév </th><th align="center">Típus </th><th align="right">Leírás  </th></tr>
<tr>
<td>id </td><td align="center">int </td><td align="right">elsődleges kulcs </td></tr>
<tr>
<td>name </td><td align="center">varchar </td><td align="right">a horgászegyesület neve </td></tr>
<tr>
<td>shire </td><td align="center">varchar </td><td align="right">a megye, ahol az egyesület található </td></tr>
</table>
<h4>Mohosz</h4>
<p>Ez a tábla szimulálja az együttműködést a Magyar Országos Horgász Szövetséggel (MOHOSZ). Ők tárolják az összes horgász legfontosabb adatait. Úgy mint a horgász nevét, kártyaszámát, a kártya kiállításának és érvényességének dátumát, az állami, vagy turista horgászjegy számát, illetve hogy volt-e valamilyen kihágása, ami miatt nem vehet állami vagy turista horgászjegyet, illetve területi jegyet. Ez egy "beégetett adatokkal" rendelkező tábla lesz, az API-ban csak lekérdezni tudjuk ezen adatokat, módosítani nem, hisz az adatkezelő nem az admin felhasználó, hanem a MOHOSZ.</p>
<table class="doxtable">
<tr>
<th>Oszlopnév </th><th align="center">Típus </th><th align="right">Leírás  </th></tr>
<tr>
<td>card_id </td><td align="center">int </td><td align="right">elsődleges kulcs, a horgászkártya ID-je </td></tr>
<tr>
<td>club_id </td><td align="center">int </td><td align="right">a horgászegyesület ID-je, aminek tagja a horgász </td></tr>
<tr>
<td>name </td><td align="center">varchar </td><td align="right">a horgász neve </td></tr>
<tr>
<td>card_issue </td><td align="center">date </td><td align="right">a horgászhoz tartozó horgászkártya kiállításának ideje </td></tr>
<tr>
<td>card_expiration </td><td align="center">date </td><td align="right">a horgászhoz tartozó horgászkártya lejáratának ideje </td></tr>
<tr>
<td>fishing_license_numb </td><td align="center">int </td><td align="right">állami vagy turista horgászjegy száma </td></tr>
<tr>
<td>is_disabled </td><td align="center">bool </td><td align="right">van-e a horgásznak kihágása </td></tr>
</table>
<h3>API végpontok</h3>
<p>Minden API végpont alakja **/api/{táblanév-kicsi-betűkkel}/** szöveg, melyet után a lenti táblázatok <em>Végpont</em> oszlopában lévő szövegek követnek. A <em>Szükséges engedély</em> oszlopban az adott végponthoz szükséges minimális jogosultság van megjelölve.</p>
<h4>Products</h4>
<table class="doxtable">
<tr>
<th>Végpont </th><th align="center">Típus </th><th>Szükséges engedély </th><th>Leírás  </th></tr>
<tr>
<td><em>semmi</em> </td><td align="center">GET </td><td>ROLE_GUEST </td><td>Visszaadja az összes terméket </td></tr>
<tr>
<td><em>semmi</em> </td><td align="center">POST </td><td>ROLE_ADMIN </td><td>A megadott terméket felviszi az adatbázisba </td></tr>
<tr>
<td>{id} </td><td align="center">DELETE </td><td>ROLE_ADMIN </td><td>Kitörli a megadott id-jű terméket </td></tr>
</table>
<h4>Order</h4>
<table class="doxtable">
<tr>
<th>Végpont </th><th align="center">Típus </th><th>Szükséges engedély </th><th>Leírás  </th></tr>
<tr>
<td><em>semmi</em> </td><td align="center">GET </td><td>ROLE_ADMIN </td><td>Visszaadja az összes rendelést </td></tr>
<tr>
<td>{user} </td><td align="center">GET </td><td>ROLE_USER </td><td>Visszaadja a felhasználó rendeléseitű </td></tr>
<tr>
<td><em>semmi</em> </td><td align="center">POST </td><td>ROLE_USER </td><td>A megadott rendelést felviszi az adatbázisba </td></tr>
<tr>
<td>{id} </td><td align="center">DELETE </td><td>ROLE_USER </td><td>Kitörli a megadott id-jű rendelést </td></tr>
</table>
<h4>Tickets</h4>
<table class="doxtable">
<tr>
<th>Végpont </th><th align="center">Típus </th><th>Szükséges engedély </th><th>Leírás  </th></tr>
<tr>
<td><em>semmi</em> </td><td align="center">GET </td><td>ROLE_USER </td><td>Visszaadja az összes jegyet </td></tr>
<tr>
<td><em>semmi</em> </td><td align="center">POST </td><td>ROLE_ADMIN </td><td>A megadott jegyet felviszi az adatbázisba </td></tr>
<tr>
<td>{id} </td><td align="center">DELETE </td><td>ROLE_ADMIN </td><td>Kitörli a megadott id-jű jegyet </td></tr>
</table>
<h4>User</h4>
<table class="doxtable">
<tr>
<th>Végpont </th><th align="center">Típus </th><th>Szükséges engedély </th><th>Leírás  </th></tr>
<tr>
<td>{id} </td><td align="center">GET </td><td>ROLE_GUEST </td><td>Visszaadja az adott id-jű felhasználót </td></tr>
<tr>
<td><em>semmi</em> </td><td align="center">GET </td><td>ROLE_ADMIN </td><td>Visszaadja az összes felhasználót </td></tr>
<tr>
<td>register </td><td align="center">POST </td><td>ROLE_ADMIN </td><td>A megadott felhasználót felviszi az adatbázisba </td></tr>
<tr>
<td>login </td><td align="center">POST </td><td>ROLE_ADMIN </td><td>A megadott felhasználót belépteti </td></tr>
<tr>
<td>{id}/to-admin </td><td align="center">PATCH </td><td>ROLE_ADMIN </td><td>A felhasználót adminná teszi </td></tr>
<tr>
<td>{id} </td><td align="center">PUT </td><td>ROLE_ADMIN </td><td>A felhasználó adatait frissíti a megadott adatokkal </td></tr>
<tr>
<td>{id} </td><td align="center">DELETE </td><td>ROLE_ADMIN </td><td>Kitörli a megadott id-jű felhasználót </td></tr>
</table>
<h4>Spots</h4>
<table class="doxtable">
<tr>
<th>Végpont </th><th align="center">Típus </th><th>Szükséges engedély </th><th>Leírás  </th></tr>
<tr>
<td>{id} </td><td align="center">GET </td><td>ROLE_GUEST </td><td>Visszaadja az adott id-jű vízterületet </td></tr>
<tr>
<td>{name} </td><td align="center">GET </td><td>ROLE_QUEST </td><td>Visszaadja az adott NEVŰ vízterületet </td></tr>
<tr>
<td><em>semmi</em> </td><td align="center">GET </td><td>ROLE_ADMIN </td><td>Visszaadja az összes vízterületet </td></tr>
<tr>
<td><em>semmi</em> </td><td align="center">POST </td><td>ROLE_ADMIN </td><td>A megadott vízterületet felviszi az adatbázisba </td></tr>
<tr>
<td>{id} </td><td align="center">PUT </td><td>ROLE_ADMIN </td><td>A vízterület adatait frissíti a megadott adatokkal </td></tr>
<tr>
<td>{id} </td><td align="center">DELETE </td><td>ROLE_ADMIN </td><td>Kitörli a megadott id-jű vízterületet </td></tr>
</table>
<h4>Clubs</h4>
<table class="doxtable">
<tr>
<th>Végpont </th><th align="center">Típus </th><th>Szükséges engedély </th><th>Leírás  </th></tr>
<tr>
<td>{id} </td><td align="center">GET </td><td>ROLE_GUEST </td><td>Visszaadja az adott id-jű horgászegyesületet </td></tr>
<tr>
<td>{name} </td><td align="center">GET </td><td>ROLE_QUEST </td><td>Visszaadja az adott NEVŰ horgászegyesület </td></tr>
<tr>
<td><em>semmi</em> </td><td align="center">GET </td><td>ROLE_ADMIN </td><td>Visszaadja az összes horgászegyesület </td></tr>
<tr>
<td><em>semmi</em> </td><td align="center">POST </td><td>ROLE_ADMIN </td><td>A megadott horgászegyesületet felviszi az adatbázisba </td></tr>
<tr>
<td>{id} </td><td align="center">PUT </td><td>ROLE_ADMIN </td><td>A horgászegyesület adatait frissíti a megadott adatokkal </td></tr>
<tr>
<td>{id} </td><td align="center">DELETE </td><td>ROLE_ADMIN </td><td>Kitörli a megadott id-jű horgászegyesületet </td></tr>
</table>
<h4>Mohosz</h4>
<table class="doxtable">
<tr>
<th>Végpont </th><th align="center">Típus </th><th>Szükséges engedély </th><th>Leírás  </th></tr>
<tr>
<td>{id} </td><td align="center">GET </td><td>ROLE_USER </td><td>Visszaadja az adott id-jű Mohosz felhasználó adatot </td></tr>
<tr>
<td><em>semmi</em> </td><td align="center">GET </td><td>ROLE_ADMIN </td><td>Visszaadja az összes felhasználó adatot a Mohosztól </td></tr>
</table>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
